import pandas as pd

# Dicionário de mapeamento CNES
mapeamento  = {101: 4001303, 102: 3970442, 103: 2000733, 104: 6627595, 105: 3004104, 106: 2013029, 107: 3151794, 108: 2566168, 
               109: 2752700, 110: 2329905, 111: 2020068, 112: 2755157, 113: 2755149, 114: 5618347, 115: 2708922, 116: 2002078, 
               117:    7641, 118: 7283458, 119: 2332671, 120: 2340992, 121:    7684, 122: 2329891, 123: 2020890, 124: 3656969, 
               125: 2017792, 126: 6205224, 127: 5084415, 128: 5332427, 130: 2792478, 131: 6185177, 132: 6440630, 133: 2496046, 
               134: 2798484, 135: 2000296, 136: 2504901, 137: 2330938, 138: 2418657, 139: 2677563, 140: 2331098, 141: 5703425, 
               142: 2615746, 143: 2020076, 144: 2017768, 145: 2622475, 146: 7360347, 147: 2678403, 148: 2418665, 149: 2619938, 
               150: 2755165, 151: 4006429, 152: 2331012, 153: 2515768, 154: 5448158, 155: 2784637, 156: 3049450, 157: 2452383, 
               158: 2458705, 159: 2702886, 160: 2309254, 161: 2323397, 162: 2679639, 163: 2679647, 164: 2806215, 165: 2409208, 
               166: 2473380, 167: 2560089, 168: 2362287, 169: 2603802, 170: 2341204, 171: 2399644, 172: 2605414, 173: 2711613, 
               174:     396, 175: 7958838, 176: 5714397, 177: 2799278, 178: 2802023, 179:    3794, 180:    3840, 181: 3956369, 
               182: 2324075, 183: 2387581, 184: 2456958, 185: 2697688, 186: 2611686, 187: 2564211, 188: 3021114, 189: 2362821, 
               190: 2315793, 191: 2319454, 192:     434, 193: 2005050, 194: 2006340, 195: 2010631, 196: 2003775, 197:    2232, 
               198: 2612518, 199: 2304325, 200:    6564, 202: 2562391, 205: 3394514, 206: 3053687, 208: 3056724, 209: 2430622, 
               210: 2517132, 211: 2355906, 212: 2517140, 213: 2308649, 214:    1120, 217: 7708963, 218:    2593, 219: 3381412, 
               220: 2389746, 221: 2802082, 222:    4251, 223: 5407591, 225: 3008045, 226: 3180387, 227: 7073224, 228: 2462583, 
               229: 7013620, 230: 2465655, 231: 2453665, 232: 2306697, 233: 2530236, 234: 6463045, 235: 2365146, 236: 8015899, 
               237: 4009622, 238: 2675560, 239: 2551764, 240: 2351994, 241: 2428393, 242: 2348489, 243: 2467372, 244: 4028414, 
               245: 2799804, 247: 2454696, 248: 2333716, 249: 2527413, 250: 2481073, 251: 2552086, 252: 2410281, 253: 2429004, 
               254: 2638991, 255: 2546027, 256: 2503824, 257: 2525569, 258: 2444828, 259: 6923356, 260: 2533480, 261: 2520613, 
               262: 2799286, 263: 2675536, 265: 2711419, 266: 5615895, 267: 3529673, 268: 5373719, 270: 2192896, 271: 2126494, 
               272: 2696924, 273: 2290227, 274: 2278324, 275: 7011857, 276: 7591136, 277: 2270390, 278: 6995462, 279: 6518893, 
               280: 2082209, 281: 2792168, 282: 2080079, 283: 2080338, 284: 2792141, 285: 2078104, 286:    8036, 287: 6998704, 
               288: 2079720, 289: 7580770, 290: 2084473, 291: 6020917, 292: 2079186, 293: 2082829, 294: 2080583, 295: 5200105, 
               296: 2066092, 297: 2077671, 298: 2065665, 299: 2079119, 300: 6966594, 301: 2079828, 302: 2749319, 303: 6146376, 
               305:   26794, 306: 2118513, 307: 2205440, 308: 2154560, 309: 2206528, 310:   11843, 311: 2296241, 312: 2087057, 
               313: 2022621, 314: 2754843, 315: 2040069, 316: 2784602, 317: 2092298, 318: 2079135, 319: 9344315, 320: 2082187, 
               321: 2082888, 322: 2705222, 323: 2076896, 324: 2081253, 325: 2765934, 326: 2765942, 329: 2773333, 332:   27944, 
               333: 3702693, 334: 2126451, 335: 2115891, 336: 3450198, 337: 5417139, 338: 3421597, 339: 3188213, 340: 3014673, 
               341: 2292157, 342: 3065634, 343: 7244339, 344: 6861873, 345: 2279525, 347: 7659415, 348: 2814188, 350: 6159397, 
               351: 3521133, 353: 3038130, 354: 7980051, 355: 2784874, 356: 2078678, 360: 2080699, 367: 2078740, 368: 6273270, 
               369: 6936024, 371: 2078082, 372: 2079607, 373: 3367371, 374: 2079542, 375: 2058391, 377: 2089777, 378: 2089602, 
               379: 6668143, 381: 3037274, 382: 2688611, 383: 6043941, 385: 2222043, 386: 2204622, 387: 5412447, 388: 7529384, 
               389:   25135, 390: 2083094, 391: 2790580, 392: 2025523, 393: 2206595, 394: 2288109, 395: 2081091, 396: 2183803, 
               397: 2145960, 398: 2135124, 399: 2153882, 400: 2173166, 401: 2108992, 402: 2149990, 403: 2119528, 404: 2136945, 
               405: 2098911, 406: 2098369, 407: 2195585, 408: 2448521, 409: 2465833, 410: 2532190, 411: 2298317, 412: 2292513, 
               413: 2092611, 414: 2705982, 415: 2077582, 416: 5860490, 417: 2090961, 418: 2096463, 419: 4049020, 420: 2080931, 
               423: 2135108, 424: 3013588, 425: 2151812, 426: 2151871, 427: 5108969, 428: 3366219, 430: 3625087, 432: 3315916, 
               434: 2815214, 436: 2738368, 437: 2753278, 438: 2579391, 439: 6854729, 440: 2436477, 441: 2504332, 442: 2555646, 
               443: 2232146, 444: 2232022, 445: 2793008, 446: 2774216, 447: 2418967, 448: 2730650, 449: 2715864, 450: 2439263, 
               451: 2594714, 452: 4056752, 453: 2522411, 454: 2301830, 455: 2303892, 456: 2522691, 457: 2377829, 458: 2568713, 
               459: 2232081, 460: 2679736, 461: 2253046, 462: 2237601, 463: 2265052, 464: 2237571, 465: 2707675, 466: 2232154, 
               467: 2553155, 468: 7274351, 469: 2241145, 470: 3165019, 474: 3000877, 475: 2587165, 476: 2522101, 477: 2521431, 
               478: 2537397, 479: 5712068, 480: 3499502, 481: 2521385, 482: 2227886, 484: 2237598, 485: 3007847, 487: 3061388, 
               489: 2687127, 490: 6542638, 491: 2244306, 492: 2557207, 493: 2753804, 494: 2591049, 495: 2686953, 496: 2733676, 
               497: 2262274, 498: 2259893, 499: 2252287, 500: 2246953, 501: 2246988, 502: 2254611, 503: 2254964, 504: 2228726, 
               505: 2733307, 506: 2252244, 507: 2666723, 508: 2249472, 509: 3506959, 511: 2263823, 512: 2339196, 513: 6402305, 
               514: 2338564, 515: 2339080, 516:   10480, 517:   10472, 518: 2645157, 519: 2672197, 520:   10529, 521: 2391635, 
               522: 2650355, 523:    9768, 524:    9709, 525:    9717, 526: 2659107, 527: 2311682, 528: 2534584, 530: 2589230, 
               532: 2604388, 533: 3427633, 534: 3074889, 535: 2535432, 537: 2570300, 538: 3013162, 539: 3019608, 540: 2815966, 
               541: 2649497, 542: 3018520, 543: 7981457, 544: 2391503, 545: 2339137, 546: 2710935, 547: 2371243, 548: 2396106, 
               549: 4069803, 550: 2371197, 551: 2395428, 552: 2646943, 553: 2756951, 554: 2472414, 555: 2396866, 556: 2795671, 
               557: 2472139, 558: 2361787, 559: 2376474, 560: 2472724, 561: 2756978, 562: 2570823, 563: 2340747, 564: 2337509
}

# Função para tratar CNES usando o mapeamento
def tratar_cnes(df, coluna, nova_coluna):
    """
    Substitui os valores de uma coluna de um DataFrame de acordo com o mapeamento CNES e salva em uma nova coluna.

    Args:
    df (pd.DataFrame): O DataFrame a ser tratado.
    coluna (str): Nome da coluna original a ser mapeada.
    nova_coluna (str): Nome da nova coluna para salvar os valores mapeados.

    Returns:
    pd.DataFrame: DataFrame com a nova coluna criada de acordo com o mapeamento CNES.
    """
    # Verificar se a coluna existe no DataFrame
    if coluna not in df.columns:
        print(f"A coluna '{coluna}' não está presente no DataFrame.")
        return df

    # Garantir que estamos modificando uma cópia para evitar SettingWithCopyWarning
    df = df.copy()

    # Aplicar o mapeamento e salvar o resultado na nova coluna
    df[nova_coluna] = df[coluna].map(mapeamento)

    # Converter a nova coluna para o tipo Int64, permitindo valores nulos
    df[nova_coluna] = df[nova_coluna].astype('Int64')

    return df


